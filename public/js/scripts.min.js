function getSelectedAnswer(){var e=document.querySelector("input[name='nr-question']:checked"),n=null;if(e){var t=e.getAttribute("nr-answer");n=document.getElementById(t).innerHTML}return n}function getQuestion(){currentQuestion=questionBank.shift()}function getQuestionNumber(){return originalBankSize-questionBank.length}function queryQuestionsWithDifficulty(e,n,t){for(var i=e.filter(function(e){return e.difficulty===n}),s=[],r=0;t>r;r++){var u=Math.floor(Math.random()*i.length);s.push(i.splice(u,1)[0])}return s}function getFirstQuestion(e){if(e[0].difficulty&&e[e.length-1].difficulty){var n=queryQuestionsWithDifficulty(e,"easy",8),t=queryQuestionsWithDifficulty(e,"medium",7),i=queryQuestionsWithDifficulty(e,"hard",6),s=queryQuestionsWithDifficulty(e,"expert",4);questionBank=[].concat(n,t,i,s)}else if(e.length>=MAX_QUIZ_LENGTH){for(var r=[],u=0;u<MAX_QUIZ_LENGTH;u++){var o=Math.floor(Math.random()*e.length);r.push(e.splice(o,1))}questionBank=r}else questionBank=e;originalBankSize=questionBank.length,getQuestion()}function queryQuizByName(e){$.getJSON("/"+e).done(function(e){currentQuizName=e["quiz-name"],getFirstQuestion(e.questions),fillQuestion(),document.getElementById("homepage-area").style.display="none",document.getElementById("finished-area").style.display="none",document.getElementById("question-area").style.display="block"}).fail(function(n){404===n.status&&(document.getElementById("quiz-not-found-label").innerHTML=e,document.getElementById("not-found-alert").style.display="block")})}function startTest(e){if(null===e){var n=document.getElementById("quiz-name-input").value;n&&n.length>0&&queryQuizByName(n)}else queryQuizByName(-1===e?currentQuizName:e)}function createQuiz(){window.location.href="/create-quiz"}function finishTest(){$.post("/grade-quiz",JSON.stringify({"quiz-name":currentQuizName,answers:answers}),function(e){var n=e.mastery_score,t=document.getElementById("mastery-rank"),i=document.getElementById("percent-progress");i.setAttribute("aria-valuenow",n),i.style.width=n+"%",document.getElementById("percent-correct-label").innerHTML=n.toString();var s="progress-bar progress-bar-striped active",r="label",u="";n>=80?(s+=" progress-bar-success",r+=" label-success",u="Companion"):n>=50?(s+=" progress-bar-warning",r+=" label-warning",u="Friend"):(s+=" progress-bar-danger",r+=" label-danger",u="Associate"),i.className=s,t.className=r,t.innerHTML=u+" of Nick",answers=[],document.getElementById("question-area").style.display="none",document.getElementById("finished-area").style.display="block",window.scrollTo(0,0)})}function fillQuestion(){document.getElementById("question-title").innerHTML="Question #"+getQuestionNumber(),document.getElementById("question-text").innerHTML=currentQuestion["question-text"],document.getElementById("possible-answer-1").innerHTML=currentQuestion.responses[0],document.getElementById("possible-answer-2").innerHTML=currentQuestion.responses[1],document.getElementById("possible-answer-3").innerHTML=currentQuestion.responses[2],document.getElementById("possible-answer-4").innerHTML=currentQuestion.responses[3]}function getNextQuestion(e){var n=currentQuestion["question-id"],t=currentQuestion.responses.indexOf(e);answers.push({key:n,value:t}),getQuestionNumber()>=originalBankSize?finishTest():(getQuestion(),fillQuestion())}function onAnswerSubmit(){var e=getSelectedAnswer();e?(document.getElementById("no-answer-alert").style.display="none",getNextQuestion(e)):document.getElementById("no-answer-alert").style.display="block"}function onHomeClick(){window.location.href="/"}var currentQuestion=null,questionBank=null,originalBankSize=-1,answers=[],currentQuizName=null;