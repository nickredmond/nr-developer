function resetQuizVariables(){questions=[],currentQuestionNum=1,isQuizNameValid=!0}function onQuizNameInput(e){document.getElementById("blank-name-alert").style.display="none",isQuizNameValid=!e.match(INVALID_NAME_PATTERN),document.getElementById("invalid-name-alert").style.display=isQuizNameValid?"none":"block"}function updateNavButtons(){document.getElementById("prev-question-btn").style.visibility=selectedQuestionIndex>0?"visible":"hidden",document.getElementById("next-question-btn").style.visibility=selectedQuestionIndex<questions.length?"visible":"hidden"}function populateFields(e){var t=e||{"question-text":"",responses:["","","",""],"correct-response-index":-1};document.getElementById("question-text-input").value=t["question-text"];for(var n=1;n<=POSSIBLE_RESPONSES_COUNT;n++)document.getElementById("response-"+n+"-input").value=t.responses[n-1];var s=document.querySelector("input[name='correct-response']:checked");if(s&&(s.checked=!1),t["correct-response-index"]>=0){var o=t["correct-response-index"]+1;document.getElementById("correct-opt-"+o).checked=!0}}function performNavigation(e){selectedQuestionIndex+=e,currentQuestionNum=selectedQuestionIndex+1,refreshView(),updateNavButtons(),setQuestionTitle()}function navigateQuestions(e){if(selectedQuestionIndex===questions.length)performNavigation(e),populateFields(questions[selectedQuestionIndex]);else if(verifyCurrentQuestion(!0)){addCurrentQuestionToQuiz(selectedQuestionIndex),performNavigation(e);selectedQuestionIndex>=questions.length?null:questions[selectedQuestionIndex];populateFields(questions[selectedQuestionIndex])}}function isStringNullOrEmpty(e){return!e||""===e.trim()}function getQuestionText(){return document.getElementById("question-text-input").value}function getResponseInputs(){var e=[];isResponsesEntered=!0;for(var t=1;t<=POSSIBLE_RESPONSES_COUNT&&isResponsesEntered;t++){var n=document.getElementById("response-"+t+"-input").value;isStringNullOrEmpty(n)?(isResponsesEntered=!1,e=[]):e.push(n)}return e}function getCorrectResponseIndex(){var e=document.querySelector("input[name='correct-response']:checked"),t=document.querySelectorAll("input[name='correct-response']"),n=Array.from(t);return e?n.indexOf(e):-1}function verifyCurrentQuestion(e){var t=!0;return isStringNullOrEmpty(getQuestionText())&&(t=!1,e&&(document.getElementById("blank-question-text-alert").style.display="block")),0===getResponseInputs().length&&(t=!1,e&&(document.getElementById("blank-responses-alert").style.display="block")),getCorrectResponseIndex()<0&&(t=!1,e&&(document.getElementById("blank-correct-response-alert").style.display="block")),t}function verifyQuizName(){var e=!0,t=document.getElementById("quiz-name-input").value;return isStringNullOrEmpty(t)&&(e=!1,document.getElementById("blank-name-alert").style.display="block"),e&&isQuizNameValid}function clearQuestionInputs(){document.getElementById("question-text-input").value="";for(var e=1;e<=POSSIBLE_RESPONSES_COUNT;e++)document.getElementById("response-"+e+"-input").value="";var t=document.querySelector("input[name='correct-response']:checked");t&&(t.checked=!1)}function refreshView(){document.getElementById("blank-name-alert").style.display="none",document.getElementById("blank-question-text-alert").style.display="none",document.getElementById("blank-responses-alert").style.display="none",document.getElementById("blank-correct-response-alert").style.display="none",document.getElementById("no-questions-alert").style.display="none",window.scrollTo(0,0)}function addCurrentQuestionToQuiz(e){var t={"question-id":currentQuestionNum,"question-text":getQuestionText(),responses:getResponseInputs(),"correct-response-index":getCorrectResponseIndex()};"undefined"==typeof e||0>e||e>=questions.length?questions.push(t):questions[e]=t}function setQuestionTitle(){document.getElementById("question-title").innerHTML="Question #"+(selectedQuestionIndex+1)}function showConfirmationModal(e){currentModalContext=e;var t=QUIZ_MODAL_ACTIONS[e];document.getElementById("confirmation-modal-title").innerHTML=t.title,document.getElementById("confirmation-modal-text").innerHTML=t.text,document.getElementById("confirm-button").innerHTML=t["button-text"],document.getElementById("confirm-button").classList="btn btn-"+t["button-class"],$("#confirmation-modal").modal()}function isQuizPublishable(){return questions.length>0&&(isCurrentQuestionBlank()||verifyCurrentQuestion(!0))}function onConfirmClick(){if("delete"===currentModalContext)clearQuestionInputs(),resetQuizVariables(),window.location.href="/";else if("publish"===currentModalContext){var e=document.getElementById("quiz-name-input").value,t={"quiz-name":e,questions:questions};$.post("/create-quiz",JSON.stringify(t)).done(function(t){document.getElementById("question-area").style.display="none",document.getElementById("quizlinkname").innerHTML=e,document.getElementById("finished-area").style.display="block",resetQuizVariables()}).fail(function(t){400===t.status&&t.responseJSON&&t.responseJSON.is_name_taken&&(document.getElementById("taken-quiz-name-label").innerHTML=e,document.getElementById("taken-name-alert").style.display="block")})}else alert("JavaScript error: Modal was expected to be open but none was found.")}function onDeleteQuizClick(){refreshView(),showConfirmationModal("delete")}function onDeleteQuestionClick(){if(refreshView(),selectedQuestionIndex>=0&&selectedQuestionIndex<questions.length){questions.splice(selectedQuestionIndex,1),selectedQuestionIndex>0&&(selectedQuestionIndex-=1,currentQuestionNum-=1),setQuestionTitle();var e=selectedQuestionIndex<questions.length?questions[selectedQuestionIndex]:{"question-text":"",responses:["","","",""],"correct-response-index":-1};document.getElementById("question-text-input").value=e["question-text"];for(var t=1;t<=POSSIBLE_RESPONSES_COUNT;t++)document.getElementById("response-"+t+"-input").value=e.responses[t-1];var n=document.querySelector("input[name='correct-response']:checked");if(n&&(n.checked=!1),e["correct-response-index"]>=0){var s=e["correct-response-index"]+1;document.getElementById("correct-opt-"+s).checked=!0}updateNavButtons()}else selectedQuestionIndex>=questions.length&&clearQuestionInputs()}function isCurrentQuestionBlank(){return isStringNullOrEmpty(getQuestionText())&&0===getResponseInputs().length&&getCorrectResponseIndex()<0}function updateInputFields(){setQuestionTitle(),clearQuestionInputs(),updateNavButtons()}function onAddQuestionClick(){refreshView(),selectedQuestionIndex<questions.length?(selectedQuestionIndex=questions.length,currentQuestionNum=selectedQuestionIndex+1,updateInputFields()):verifyCurrentQuestion(!0)&&(addCurrentQuestionToQuiz(),selectedQuestionIndex+=1,currentQuestionNum+=1,updateInputFields())}function onPublishQuizClick(){refreshView(),verifyQuizName()&&(!isCurrentQuestionBlank()&&verifyCurrentQuestion(!1)&&addCurrentQuestionToQuiz(),isQuizPublishable()?isCurrentQuestionBlank()||selectedQuestionIndex<questions.length?showConfirmationModal("publish"):verifyCurrentQuestion(!0)&&(addCurrentQuestionToQuiz(),showConfirmationModal("publish")):0===questions.length&&(document.getElementById("no-questions-alert").style.display="block"))}function onHomeClick(){window.location.href="/"}var isQuizNameValid=!0,questions=[],currentQuestionNum=1,selectedQuestionIndex=0,currentModalContext=null;